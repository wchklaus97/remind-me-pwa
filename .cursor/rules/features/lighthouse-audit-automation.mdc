---
alwaysApply: true
description: Automated Lighthouse auditing patterns and best practices
---
# Lighthouse Audit Automation

## ğŸ¯ Purpose

Automate Lighthouse audits to ensure consistent 100% scores across all categories, presets, and URL paths.

## ğŸ“‹ Audit Script

### Location

`lighthouse-audit.sh` - Main audit script

### Usage

```bash
# Test local development server (default: http://localhost:8080)
./lighthouse-audit.sh

# Test specific URL
./lighthouse-audit.sh http://localhost:8080

# Test production URL
./lighthouse-audit.sh https://wchklaus97.github.io/remind-me-pwa
```

### Features

- âœ… Tests all URL paths (/, /app, /#app)
- âœ… Tests both mobile and desktop presets
- âœ… Generates JSON and HTML reports
- âœ… Validates scores meet 100% requirement
- âœ… Provides detailed summary

## ğŸ”§ Prerequisites

### Required Tools

1. **Lighthouse CLI**:
   ```bash
   npm install -g lighthouse
   ```

2. **Node.js** (for score extraction):
   ```bash
   # Check if installed
   node --version
   ```

### Installation

```bash
# Make script executable
chmod +x lighthouse-audit.sh

# Install Lighthouse CLI
npm install -g lighthouse
```

## ğŸ“Š Test Coverage

### URL Paths Tested

- `/` - Landing page
- `/app` - Application page
- `/#app` - Application page (hash route)

### Presets Tested

- **mobile** - Mobile device preset
- **desktop** - Desktop device preset

### Categories Tested

- Performance
- Accessibility
- Best Practices
- SEO

## ğŸ¯ Score Requirements

**Minimum Score**: 100% for all categories

The script will:
- âœ… Pass if all scores â‰¥ 100%
- âŒ Fail if any score < 100%

## ğŸ“ Output

### Report Location

`./lighthouse-reports/` directory

### Report Files

- `{path}_{preset}_{timestamp}.report.json` - JSON report
- `{path}_{preset}_{timestamp}.report.html` - HTML report

### Example Files

```
lighthouse-reports/
â”œâ”€â”€ root_mobile_20250102_143022.report.json
â”œâ”€â”€ root_mobile_20250102_143022.report.html
â”œâ”€â”€ root_desktop_20250102_143022.report.json
â”œâ”€â”€ root_desktop_20250102_143022.report.html
â”œâ”€â”€ _app_mobile_20250102_143022.report.json
â”œâ”€â”€ _app_mobile_20250102_143022.report.html
â””â”€â”€ ...
```

## ğŸ”„ Integration

### Pre-Commit Hook

Add to `.git/hooks/pre-commit`:

```bash
#!/bin/bash
# Run Lighthouse audit before commit
./lighthouse-audit.sh http://localhost:8080
if [ $? -ne 0 ]; then
    echo "Lighthouse audit failed. Please fix issues before committing."
    exit 1
fi
```

### CI/CD Integration

Add to `.github/workflows/deploy.yml`:

```yaml
- name: Run Lighthouse Audit
  run: |
    # Start local server
    dx serve &
    sleep 10
    
    # Run audit
    ./lighthouse-audit.sh http://localhost:8080
    
    # Upload reports as artifacts
    if [ -d "lighthouse-reports" ]; then
      mkdir -p lighthouse-artifacts
      cp lighthouse-reports/*.html lighthouse-artifacts/
    fi
```

## ğŸ“‹ Best Practices

### DO:
- âœ… Run audit before every commit
- âœ… Run audit on both local and production URLs
- âœ… Review HTML reports for detailed insights
- âœ… Fix issues immediately if scores drop below 100%
- âœ… Keep reports for historical tracking

### DON'T:
- âŒ Don't commit if audit fails
- âŒ Don't ignore score drops
- âŒ Don't skip mobile preset testing
- âŒ Don't test only one URL path

## ğŸ§ª Manual Testing

### Quick Test

```bash
# Test single URL and preset
lighthouse http://localhost:8080 \
  --preset=mobile \
  --output=html \
  --output-path=./report.html \
  --view
```

### Full Test Suite

```bash
# Run full audit suite
./lighthouse-audit.sh
```

## ğŸ” Troubleshooting

### Issue: Lighthouse CLI not found

**Solution**:
```bash
npm install -g lighthouse
```

### Issue: Node.js not found

**Solution**:
```bash
# Install Node.js
# macOS: brew install node
# Linux: apt-get install nodejs
```

### Issue: Scores below 100%

**Solution**:
1. Review HTML reports for detailed issues
2. Check `.cursor/CODE_STANDARDS_100.md` for requirements
3. Fix issues according to zero tolerance rules
4. Re-run audit

### Issue: Server not running

**Solution**:
```bash
# Start development server
dx serve

# Or build and serve
dx build --release --platform web
dx serve
```

## ğŸ“š Resources

- [Lighthouse CLI Documentation](https://github.com/GoogleChrome/lighthouse/blob/main/docs/cli.md)
- [Lighthouse Scoring Guide](https://developer.chrome.com/docs/lighthouse/performance/performance-scoring/)
- [Code Standards for 100%](./core/code-standards-100.mdc)
